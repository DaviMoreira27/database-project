<div class="flex h-screen w-full overflow-hidden bg-slate-50">
  <app-navbar></app-navbar>

  <div class="flex flex-col flex-1 h-full overflow-hidden relative">
    <app-header></app-header>

    <main class="flex-1 overflow-y-auto p-12">
      @if (this.loading()) {
      <div class="flex justify-center items-center w-full h-full">
        <p-progress-spinner ariaLabel="loading" />
      </div>
      } @else {
      <div class="flex flex-col gap-6 max-w-10/12 mx-auto">
        <!-- Receita Mensal -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 flex flex-col">
          <h2 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">
            Receita Mensal
          </h2>

          <div class="relative w-full h-56 flex items-end justify-center">
            <p-chart
              type="line"
              [data]="receitaData"
              [options]="compactOptions"
              class="w-full h-full"
            ></p-chart>
          </div>

          <table class="w-full text-sm mt-4 border-t">
            <thead>
              <tr class="text-left">
                <th class="py-2">Mês</th>
                <th class="py-2">Receita</th>
              </tr>
            </thead>
            <tbody>
              @for (r of this.receitaMensalDataBrute; track r) {
              <tr>
                <td class="py-1">{{ r.mes }}</td>
                <td class="py-1">{{ r.receita }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Qualidade (Problemas) -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 flex flex-col">
          <h2 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">
            Qualidade (Problemas)
          </h2>

          <div class="relative w-full h-56 flex items-end justify-center">
            <p-chart
              type="bar"
              [data]="problemasData"
              [options]="compactOptions"
              class="w-full h-full"
            ></p-chart>
          </div>

          <table class="w-full text-sm mt-4 border-t">
            <thead>
              <tr class="text-left">
                <th class="py-2">Infra</th>
                <th class="py-2">Problemas</th>
                <th class="py-2">Avaliações</th>
                <th class="py-2">Razão</th>
              </tr>
            </thead>
            <tbody>
              @for (p of this.problemasPorAvaliacaoDataBrute; track p) {
              <tr>
                <td class="py-1">{{ p.n_registro }}</td>
                <td class="py-1">{{ p.problemas }}</td>
                <td class="py-1">{{ p.avaliacoes }}</td>
                <td class="py-1">{{ p.razao_problema_por_avaliacao }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Frota Estacionada -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 flex flex-col">
          <h2 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">
            Frota Estacionada
          </h2>

          <div class="relative w-full h-72 flex items-center justify-center">
            <p-chart
              type="pie"
              [data]="bicicletasData"
              [options]="compactOptions"
              class="w-full h-full"
            ></p-chart>
          </div>

          <table class="w-full text-sm mt-4 border-t">
            <thead>
              <tr class="text-left">
                <th class="py-2">Ponto</th>
                <th class="py-2">Total</th>
                <th class="py-2">No Ponto</th>
                <th class="py-2">%</th>
              </tr>
            </thead>
            <tbody>
              @for (b of this.bicicletasEstacionadasDataBrute; track b) {
              <tr>
                <td class="py-1">{{ b.ponto_retirada }}</td>
                <td class="py-1">{{ b.total_estacionadas }}</td>
                <td class="py-1">{{ b.estacionadas_no_ponto }}</td>
                <td class="py-1">{{ b.percentual_relacional }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Ocupação / Ponto -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 flex flex-col">
          <h2 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">
            Ocupação / Ponto
          </h2>

          <div class="relative w-full h-56 flex items-center justify-center">
            <p-chart
              type="bar"
              [data]="estacionamentoData"
              [options]="compactOptions"
              class="w-full h-full"
            ></p-chart>
          </div>

          <table class="w-full text-sm mt-4 border-t">
            <thead>
              <tr class="text-left">
                <th class="py-2">Ponto</th>
                <th class="py-2">Capacidade</th>
                <th class="py-2">Disponíveis</th>
                <th class="py-2">Taxa</th>
              </tr>
            </thead>
            <tbody>
              @for (e of this.taxaOcupacaoDataBrute; track e) {
              <tr>
                <td class="py-1">{{ e.n_registro }}</td>
                <td class="py-1">{{ e.capacidade }}</td>
                <td class="py-1">{{ e.bicicletas_disponiveis }}</td>
                <td class="py-1">{{ e.taxa_ocupacao }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Totens Ativos Todos os Dias -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 flex flex-col">
          <h2 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">
            Totens que tiveram sessão em todos os dias de operação
          </h2>

          <div class="relative w-full h-56 flex items-end justify-center">
            <p-chart
              type="bar"
              [data]="totensAtivosData"
              [options]="compactOptions"
              class="w-full h-full"
            ></p-chart>
          </div>

          <table class="w-full text-sm mt-4 border-t">
            <thead>
              <tr class="text-left">
                <th class="py-2">Totem</th>
              </tr>
            </thead>
            <tbody>
              @for (t of this.totensAtivosDataBrute; track t) {
              <tr>
                <td class="py-1">{{ t.n_registro }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
      }
    </main>
  </div>
</div>
